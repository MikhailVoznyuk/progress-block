# Прототип блока Progress для моб. приложений
## Реализованная функциональность 
- Блок Progress показывает прогресс от 0 до 100 в виде частично заполненной дуги окружности. Поддерживает состояния hidden и animating. Анимация реализована в виде движения дуги по часовой стрелке с сохранением текущего прогресса. 
-  Поле для ввода позволяет ввести текущее состояние прогресса, а переключатели Animate / Hide анимировать и скрыть блок Progress соответсвенно. 
- Верстка поддерживает landscape и portrait ориентацию. 

## Стек
- HTML / CSS
- JavaScript (ES Modules)

## Запуск
- [GitHub Pages](https://mikhailvoznyuk.github.io/progress-block/)
- Локально путем открытия файла index.html (сборщик не нужен).

## Особенности и edge кейсы
- По причине невозможности использовать TypeScript, повсеместно используется явное приведение и проверка типов. 
- Для десктопа не вносятся никакие изменения в верстку. Приложение просто выравнивается по центру экрана. 
- state.progress обновляется на каждый input event. Учтены попытки внести некорректное значение в поле для ввода прогресса. Если не удается спарсить значение как число - в state.progress устанавливается значение 0. Дробные значения игнорируются (ввод "." и "," в input отбрасывается как невалидный).
- Плавное изменение размеров дуги прогресса реализовано через регистрацию свойства (--p) через "@property". В браузерах без поддержки "@property" дуга будет обновляться без transition.
- Компонент Progress принимает опциональные пропсы size и stroke, задающие размер блока и ширину дуги. Но их указание сбивает стандартную адаптивную верстку. 

## Составляющие приложения 

- index.html - базовая конфигурация документа с указанием корня приложения и подключением entrypoint'а.
- index.js - входная точка в приложение. Импортирует App и вызывает его с передачей корневого узла.
- app.js - основное веб приложение. Собирает layout, маунтит компоненты, хранит текущее состояние и при изменении вызывает сеттеры состояния компонента Progress. 
- components/progress.js - блок прогресса. Принимает значения progress, animating и hidden. Реализует отображение текущего прогресса в виде частично заполненной дуги, поддерживает анимацию и скрытие. Независим от других и не использует внутри какие-либо внешние состояния. Управление производится исключительно через его методы. 
- components/InputField.js - поле для ввода значения числового типа. Используется для ввода текущего прогресса
- components/ToggleButton.js - переключатель логического состояния в виде переключателя. Используется для изменения состояний animated / hidden.
- index.css - единый файл стилей.
- shared/utils/createEl.js - утилитарная функция для более быстрого создания DOM элементов (в рамках задачи), написана для уменьшения boilerplate. 
- shared/utils/clampPercent.js - утилитарная функция для отбрасывания значений ввода за пределами [0, 100].

## Детали реализизации
- Практически все приложение реализовано на JS с использованием компонентного подхода. В index.html указан только корень, куда монтируется приложение. 
- Компоненты App и Progress реализованы в виде классов ввиду необходимости поддержки внутреннего состояния, примитивного жизненного цикла и публичного API. Контролы реализованы как функции. Тем не менее все компоненты имеют схожий контракт: сеттеры состояния, геттеры (опционально), mount, destroy.
- Контролы реализованы как управляемые компоненты с единственным источником истины в App. При изменении они вызывают callbacks, App валидирует / нормализует новое значение (в т.ч. для state.progress) и сохраняет его в состоянии. Затем выполняется синхронизация контролов через sync: App вызывает сеттеры ToggleButton и InputField, передавая актуальные значения из state.
- Дуга реализована через conic-gradient. Размер определяется переменной --p, которая задается внутри Progress. Верстка блока производилась в три слоя: нижний div - незаполненная часть дуги. Средний блок с коническим углом перекрывает нижний, показывая заполненную дугу, и верхний блок центрирован посередине с небольшим отступом = stroke, перекрывает все до stroke имитируя пустое пространство по центру и создавая кольцо.
- Состояние hidden в Progress ставит на элемент display: none, состояние animating добавляет бесконечную css анимацию (transform: rotate(360deg)) на элемент заполненной дуги .progress__ring, при этом состояние прогресса сохраняется.




